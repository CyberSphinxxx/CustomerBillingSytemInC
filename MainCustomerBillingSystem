#include <stdio.h>
#include <string.h>
	
void interface(){
    printf("\n\t\t----------------------------------------\n");
    printf("\t\t Welcome to Customer Billing System!\n\n");
    printf("\t\t1.\tAdd Account\n");
    printf("\t\t2.\tSearch Account by Name\n");
    printf("\t\t3.\tSearch Account by Number\n");
    printf("\t\t4.\tExit\n");
    printf("\n\t\t----------------------------------------\n");
}
	
struct Database {
    char name[50];
    char number[50];
    int balance;
};
	
int checkDuplicate(struct Database customers[], int totalCustomers, char name[], char number[]) {
    int i;
    for ( i = 0; i < totalCustomers; i++) {
        if (strcmp(customers[i].name, name) == 0 || strcmp(customers[i].number, number) == 0) {
            return 1;
        }
    }
    return 0;
}
	
int main() {
    struct Database customers[100];
    int totalCustomers = 0;

    int choice;

    while (1) {
    interface();

    printf("\t\tEnter Choice: ");
    scanf("%d", &choice);

    if (choice == 1) {
        if (totalCustomers < 100) {
            char tempName[50];
            char tempNumber[50];

            printf("\t\tEnter Account Name: ");
            scanf("%s", tempName);

            printf("\n\t\tEnter Account Number: ");
            scanf("%s", tempNumber);

            if (checkDuplicate(customers, totalCustomers, tempName, tempNumber)) {
                printf("\t\tAccount with this name or number already exists!\n");
            } else {
                strcpy(customers[totalCustomers].name, tempName);
                strcpy(customers[totalCustomers].number, tempNumber);
                printf("\t\tAccount Name \"%s\" with the account Number \"%s\" added!\n", customers[totalCustomers].name, customers[totalCustomers].number);

                customers[totalCustomers].balance = 0;
                totalCustomers++;
            }
        } 
    }

    else if (choice == 2 || choice == 3) {
    char searchValue[50];

    if (choice == 2) {
        printf("\t\tEnter Account name: "); 
    }

    else {
        printf("\t\tEnter Account Number: ");
    }

    scanf("%s", searchValue);

    int found = 0;
    int i;
    for (i = 0; i < totalCustomers; i++) {
        if ((choice == 2 && strcmp(customers[i].name, searchValue) == 0) ||
            (choice == 3 && strcmp(customers[i].number, searchValue) == 0)) {

		printf("\n\t\t-----------------------------------\n");
		printf("\t\tWelcome %s!\n", customers[i].name);
		printf("\t\tWhat do you want to do?\n");
		printf("\t\t1.\tCheck Balance\n");
        printf("\t\t2.\tDeposit Money\n");
        printf("\t\t3.\tWithdraw Money\n");
		printf("\t\t4.\tAdd Due Amount\n");
		printf("\t\t5.\tExit\n");
		printf("\n\t\t-----------------------------------\n");
		
		int customerChoice;
		while (1) {
		    printf("\n\t\tEnter Your Choice: ");
		    scanf("%d", &customerChoice);
		
		    if (customerChoice == 1) {
		        printf("\t\tYour balance is: Php %d\n", customers[i].balance);
		    }

            else if(customerChoice == 2){
                printf("\t\tEnter Amount to deposit: ");
                int depAmount;
                scanf("%d",&depAmount);
                customers[i].balance+=depAmount;
                printf("\t\tYour balance is now: %d\n",customers[i].balance);
            }
		
            else if (customerChoice == 3){
                printf("\t\tEnter Amount to Withdraw: ");
                int withDraw=0;
                scanf("%d",&withDraw);
                
                if(withDraw > customers[i].balance){
                    printf("\t\tInsufficient Balance!");
                }
                    
                    else{
                        customers[i].balance-=withDraw;
                        printf("\t\tYour new balance is: %d\n",customers[i].balance);
                    }
            }
            

		    else if (customerChoice == 4) {
		        int amountToAdd;
		        printf("\t\tEnter Due Amount: ");
		        scanf("%d", &amountToAdd);

		        customers[i].balance -= amountToAdd; 
		        printf("\t\tYour due amount is: Php %d\n", customers[i].balance); 
		    }

		    else if (customerChoice == 5) {
		        printf("\n\t\t-------Goodbye %s!----------\n", customers[i].name);
		        break;
		    }
		}

		found = 1;
		break;

        }
    }
    
            if (!found) {
                if (choice == 2) {
                    printf("\t\tThere's no Customer with name %s\n", searchValue);
                }

                else{
                    printf("\t\tThere's no Customer with Account Number %s\n", searchValue);
                }
            }
        }
        
        else if (choice == 4) {
        break;
        }

        else {
            printf("\t\tInvalid Choice!\n");
        }
    }

    printf("\n\t\t------GoodBye!--------\n");
    return 0;
}
